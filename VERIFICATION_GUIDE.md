# Verification Guide

This guide outlines how to verify the accuracy of the results generated by the NPS Analysis Desktop App. You can use external tools like Microsoft Excel, SPSS, or Python (pandas) to cross-check the numbers.

## 1. Verifying Weighted Counts

The fundamental check is to ensure that the sum of weights matches the total number of respondents (or the target population size, depending on scaling).

**Steps:**
1.  Export the processed data (if available) or check the "Total Count" in the dashboard.
2.  **Formula**: $\sum (Respondent Weight) = Total Sample Size$
3.  **Check**: The weighted sum of respondents for any demographic variable (e.g., Male + Female) should exactly match the Total Sample Size.

## 2. Verifying Weighting Efficiency

Check if the weighting has correctly aligned the sample distribution with the population targets.

**Steps:**
1.  Look at the "Weighting Efficiency" or "Distribution" charts in the dashboard (if available) or calculate manually.
2.  For each weighting variable (e.g., Gender):
    *   Calculate the **Weighted Sum** of each category (e.g., Sum of weights for Males).
    *   Calculate the **Weighted Percentage**: $(Weighted Sum / Total Sum) * 100$.
    *   **Compare**: This percentage should match your input Population Target exactly (e.g., if Target Male is 50%, Weighted % should be 50.0%).

## 3. Verifying NPS Score

NPS is calculated using the weighted counts of Promoters, Passives, and Detractors.

**Formula:**
$$NPS = (\% Promoters_{weighted} - \% Detractors_{weighted}) * 100$$

**Manual Calculation Steps:**
1.  **Identify Groups**:
    *   **Promoters**: Score 9-10
    *   **Passives**: Score 7-8
    *   **Detractors**: Score 0-6
2.  **Sum Weights**:
    *   $W_{promoters} = \sum \text{Weights of Promoters}$
    *   $W_{detractors} = \sum \text{Weights of Detractors}$
    *   $W_{total} = \sum \text{All Weights}$
3.  **Calculate Percentages**:
    *   $\% P = (W_{promoters} / W_{total}) * 100$
    *   $\% D = (W_{detractors} / W_{total}) * 100$
4.  **Calculate NPS**:
    *   $NPS = \% P - \% D$
    *   *Note: Round to 1 decimal place.*

## 4. Verifying Top Box %

Top Box (usually Top 2 or Top 3) is calculated similarly to NPS but focuses on the highest scores.

**Formula (Top 2 Box):**
$$Top2Box \% = \frac{\sum \text{Weights of (Score 4 + Score 5)}}{\sum \text{All Weights}} * 100$$
*(Assuming a 5-point scale)*

**Steps:**
1.  Filter for respondents who selected the Top Box scores (e.g., 4 or 5 on a 5-point scale, 6 or 7 on a 7-point scale).
2.  Sum their weights.
3.  Divide by the total sum of weights and multiply by 100.

## Common Discrepancies

*   **Rounding Differences**: The app calculates using high-precision floats and rounds at the final step. Manual calculations in Excel might round intermediate steps, leading to small differences (e.g., +/- 0.1).
*   **Missing Data**: Ensure that respondents with missing data for Weighting Variables or the NPS score are excluded from the calculation (or handled as per your specific rules). The app typically excludes respondents with missing weighting variables from the weight calculation.
